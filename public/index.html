<!doctype html>
<html class="no-js" lang="en">

<head>
    <meta charset="utf-8">
    <title>Maps - FCC GIS</title>
    <link rel="shortcut icon" href="https://www.fcc.gov/sites/all/themes/fcc/favicon.ico" type="image/vnd.microsoft.icon" />
    <meta name="MobileOptimized" content="width">
    <meta name="HandheldFriendly" content="true">
    <meta name="viewport" content="width=device-width">
    <meta http-equiv="cleartype" content="on">
    <link href="//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,700italic,400,300,700" rel="stylesheet" />
    <link href="https://api.tiles.mapbox.com/mapbox.js/v2.3.0/mapbox.css" rel="stylesheet" />
    <link href="map_templates/css/gisp-theme.min.css" rel="stylesheet" />
    <link href="//code.jquery.com/ui/1.11.4/themes/smoothness/jquery-ui.css" rel="stylesheet">
</head>

<body class="docs-collapsed-nav">
    <!--[if lt IE 9]>
        <p class="browsehappy">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p>
    <![endif]-->
    <header class="navbar navbar-primary site-header">
        <div class="container">
            <div class="jumpLinks"> <a href="#skiptarget1" class="sr-only focusable">Skip to main content</a> <a href="#skiptarget3" class="sr-only focusable">Skip to footer and contact information</a> </div>
            <nav role="navigation">
                <div class="navbar-header">
                    <h1 class="navbar-brand">
                  <a title="Home" href="http://fcc.gov" class="navbar-logo">
                    <span class="sr-only">Federal Communications Commission</span>
                  </a>
                </h1>
                </div>
                <ul aria-hidden="true" id="menu-primary" class="nav navbar-nav nav-offcanvas-right">
                    <li>
                        <a class="" href="/">
                            <!-- <div class="text-prefix">&nbsp;</div> -->
                            <strong class="title-emphasis">Maps</strong>
                        </a>
                    </li>
                </ul>
            </nav>
        </div>
    </header>
    <main class="container">
        <div class="grid-maps row">
            <div class="col-sm-12">
                <div class="row">
                    <div class="col-xs-6 col-sm-6">
                        <h1>Maps</h1>
                    </div>
                    <div class="col-xs-6 col-sm-6">
                        <a class="navbar-about" href="about.html">About</a>
                    </div>
                </div>
                <div class="gallery-filters row">
                    <div class="gallery__numResults">Showing: 0 maps</div>
                    <div class="gallery__filterOpts">
                        <div class="btn-group btn-group-sm" role="group" aria-label="Map view options">
                            <button type="button" class="btn btn-default">All</button>
                            <button type="button" class="btn btn-default active">Current</button>
                            <button type="button" class="btn btn-default">Featured</button>
                            <button type="button" class="btn btn-default">Archive</button>
                        </div>
                        <div class="form-inline">
                            <label class="control-label" for="sel-filter">Bureau:</label>
                            <select id="sel-filter" class="form-control form-control-width-sm">
                                <option value="all">Show all</option>
                                <!-- <option value="MB">Media Bureau</option>
                                <option value="OSP">Office of Strategic Planning and Policy Analysis</option>
                                <option value="OET">Office Engineering and Technology</option>
                                <option value="WCB">Wireline Competition</option>
                                <option value="WTB">Wireless Telecommunications Bureau</option> -->
                            </select>
                            <label class="control-label" for="sel-sort">Sort:</label>
                            <select id="sel-sort" class="form-control form-control-width-sm">
                                <option value="dateDesc" selected>Newest</option>
                                <option value="dateAsc">Oldest</option>
                                <option value="titleAsc">Title (A-Z)</option>
                                <option value="titleDesc">Title (Z-A)</option>
                            </select>
                            <a href="#void" class="link-clearFilters">Reset Filters</a>
                        </div>
                    </div>
                </div>
                <div class="tag-list-inline hide">
                    <a class="link-removeTags h6" href="#void">Tags</a>
                    <ul class="list-tags list-unstyled"></ul>
                </div>
                <div class="alert-noResults h4 hide">
                    There selected filters did not match any maps. Please revise your selections and try again.
                </div>
                <ul id="map-list-holder" class="map-cards list-unstyled"></ul>
            </div>
        </div>
    </main>
    <footer class="container">
        <div class="row">
            <div class="col-sm-12">
                <div class="nav-footer">
                    <div class="footergriditems">
                        <div class="grid-item">
                            <address>
                                Federal Communications Commission
                                <br> 445 12th Street SW, Washington, DC 20554
                            </address>
                            <ul class="footermenu footermenu__phone">
                                <li><a class="phone-link" href="tel:+18882255322">Phone: 1-888-225-5322</a></li>
                                <li><a class="phone-link" href="tel:+18888355322">TTY: 1-888-835-5322</a></li>
                                <li><a class="phone-link" href="tel:+18444322275">Videophone: 1-844-432-2275</a></li>
                                <li><a class="phone-link" href="tel:+18664180232">Fax: 1-866-418-0232</a></li>
                                <a class="contactus" href="/about/contact">Contact Us</a>
                            </ul>
                            <ul class="socialmediaicons">
                                <li><a class="link-ext social-media twitter" href="https://twitter.com/fcc">Twitter</a></li>
                                <li><a class="link-ext social-media facebook" href="https://www.facebook.com/FCC">Facebook</a></li>
                                <li><a class="link-ext social-media youtube" href="https://www.youtube.com/user/fccdotgovvideo">Youtube</a></li>
                                <li><a class="link-ext social-media flickr" href="https://www.flickr.com/photos/fccdotgov">Flickr</a></li>
                                <li><a class="link-ext social-media instagram" href="https://www.instagram.com/fcc">Instagram</a></li>
                            </ul>
                        </div>
                        <div class="grid-item">
                            <ul class="footermenu footermenu__categories">
                                <li><a href="/general/website-notices">Website Policies &amp; Notices</a></li>
                                <li><a href="/general/foia-0">FOIA</a></li>
                                <li><a href="/general/no-fear-act-data">No Fear Act Data</a></li>
                                <li><a href="/digitalstrategy">FCC Digital Strategy</a></li>
                                <li><a href="/general/open-government-fcc">Open Government Directive</a></li>
                                <li><a href="/general/plain-writing-fcc">Plain Writing Act</a></li>
                                <li><a href="/general/rss-feeds-and-email-updates-fcc">RSS Feeds &amp; Email Updates</a></li>
                                <li><a href="/general/disability-rights-office">Disability Rights</a></li>
                            </ul>
                        </div>
                        <div class="grid-item">
                            <ul class="footermenu footermenu__categories">
                                <li>CATEGORIES</li>
                                <li><a href="/about/overview">About the FCC</a></li>
                                <li><a href="/proceedings-actions">Proceedings &amp; Actions</a></li>
                                <li><a href="/licensing">Licensing &amp; Databases</a></li>
                                <li><a href="/reports-research">Reports &amp; Research</a></li>
                                <li><a href="/news-events">News &amp; Events</a></li>
                                <li><a href="/consumers">For Consumers</a></li>
                            </ul>
                        </div>
                        <div class="grid-item">
                            <ul class="footermenu footermenu__bureaus">
                                <li>BUREAUS &amp; OFFICES</li>
                                <li><a href="/consumer-and-governmental-affairs#block-menu-block-4">Consumer</a></li>
                                <li><a href="/enforcement#block-menu-block-4">Enforcement</a></li>
                                <li><a href="/inspector-general">Inspector General</a></li>
                                <li><a href="/international#block-menu-block-4">International</a></li>
                                <li><a href="/media#block-menu-block-4">Media</a></li>
                                <li><a href="/public-safety-and-homeland-security#block-menu-block-4">Public Safety</a></li>
                                <li><a href="/wireless-telecommunications#block-menu-block-4">Wireless</a></li>
                                <li><a href="/wireline-competition#block-menu-block-4">Wireline</a></li>
                                <li><a href="/offices-bureaus#block-menu-block-4">Offices</a></li>
                            </ul>
                        </div>
                    </div>
                    <div class="fcc-seal">
                        Federal Communications Commission
                    </div>
                </div>
            </div>
        </div>
    </footer>
    <script src="//code.jquery.com/jquery-1.11.2.min.js"></script>
    <script>
    window.jQuery || document.write('<script src="js/vendor/jquery-1.11.2.min.js"><\/script>')
    </script>
    <script src="//code.jquery.com/ui/1.11.4/jquery-ui.min.js"></script>
    <script>
    window.jQuery.ui || document.write('<script src="js/vendor/jquery-ui.min.js"><\/script>')
    </script>
    <script src="map_templates/js/vendor/isotope.min.js"></script>
    <script src="map_templates/js/map-gallery.js"></script>
    <script src="map_templates/js/apps.js"></script>
    <script>
    function populateMaps() {

        var url = "/getExistingMaps";
        $.ajax(url, {
            type: "GET",
            url: url,
            dataType: "json",
            success: function(data) {
                console.log(data);
                var urls = [];
                var titles = [];
                var subtitles = [];
                var descriptions = [];
                var vids = [];
                var create_tss = [];
                var zooms = [];
                var center_lats = [];
                var center_lons = [];
                var searches = [];
                var bureaus = [];
                var dates = [];

                for (var i = 1; i < data.length; i++) {

                    var title = data[i].title;
                    var nid = data[i].nid;
                    var vid = data[i].vid;
                    var created = data[i].created;
                    var changed = data[i].changed;
                    var updated = ""
                    if (data[i].fields.field_date_updated_reviewed.und) {
                        updated = data[i].fields.field_date_updated_reviewed.und[0].value;
                    }
                    var url = "";
                    if (data[i].fields.field_map_page_url.und) {
                        url = data[i].fields.field_map_page_url.und[0].url;
                    }
                    var repo = "";
                    if (data[i].fields.field_map_repository.und) {
                        repo = data[i].fields.field_map_repository.und[0].url;
                    }
                    var subtitle = "";
                    if (data[i].fields.field_subtitle.und) {
                        subtitle = data[i].fields.field_subtitle.und[0].value;
                    }

                    if (url + repo != "") {
                        urls.push(url);
                        titles.push(title);
                        subtitles.push(subtitle);
                        descriptions.push("Descriptions go here");
                        vids.push(vid);
                        create_tss.push(created);
                        var bureau = "";
                        if (data[i].fields.field_description.und) {
                            var desc_str = data[i].fields.field_description.und[0].value;
                            var desc_json = JSON.parse(desc_str);
                            bureau = desc_json.bureau;
                        }
                        bureaus.push(bureau);
                        dates.push(changed);

                        var map_info = "";
                        if (data[i].fields.field_description.und) {
                            var value_str = data[i].fields.field_description.und[0].value;
                            var map_info = JSON.parse(value_str);
                        }
                        if (map_info != "") {
                            zooms.push(map_info.mapzoom.initialzoom);
                            center_lats.push(map_info.mapcenter.latitude);
                            center_lons.push(map_info.mapcenter.longitude);
                        } else {
                            zooms.push(3);
                            center_lats.push(40);
                            center_lons.push(-105);
                        }
                    }




                }

                // populate bureau filter dropdown
                function getBureauFilters() {
                    var bureauFilters = [],
                        options = '',
                        bureauAbbr = {
                            'MB': 'Media Bureau',
                            'OSP': 'Office of Strategic Policy and Planning Analysis',
                            'WTB': 'Wireless Telecommunications',
                            'OET': 'Office of Engineering and Technology',
                            'WCB': 'Wireline Competition',
                            'PSHSB': ' Public Safety and Homeland Security',
                            'IB': 'International Bureau',
                            'EB': 'Enforcement Bureau',
                            'CGB': 'Consumer and Governmental Affairs Bureau'
                        };

                    function arrUnique(arr) {
                        var i,
                            len = arr.length,
                            unique = [],
                            obj = {};

                        for (i = 0; i < len; i++) {
                            obj[arr[i]] = 0;
                        }
                        for (i in obj) {
                            unique.push(i);
                        }
                        return unique;
                    }

                    bureauFilters = arrUnique(bureaus).sort();

                    for (var k = 0; k < bureauFilters.length; k++) {
                        options += '<option value="' + bureauFilters[k] + '">' + bureauAbbr[bureauFilters[k]] + '</option>';
                    }

                    $('#sel-filter').find('option').eq(0).after(options);

                }

                getBureauFilters();


                var text = '';
                for (var i = 0; i < urls.length; i++) {

                    var url = urls[i] + "/responsive.html";
                    var url_bookmark = urls[i] + "/#" + zooms[i] + "/" + center_lats[i] + "/" + center_lons[i] + "/zoom,attr,layers,key,search";
                    text += '<li class="card bureau-' + bureaus[i] + ' tag-data-maps-reports tag-maps"> \
                            <div class="mapThumb-btns"> \
                                <a class="btn btn-xs btn-default" href="' + url_bookmark + '"><span class="sr-only">View map</span> <span class="icon icon-external-link-square"></span></a> \
                            </div> \
                            <iframe src="' + url + '"></iframe> \
                            <p class="card__title text-overflow"><a href="' + url_bookmark + '"><span >' + titles[i] + '</span></a></p> \
                            <div class="card__meta"> \
                                <div class="pull-left">' + bureaus[i] + '</div> \
                                <div class="pull-right data-date">' + dates[i] + '</div> \
                            </div> \
                            <div class="card__body" aria-expanded="false" style="display: none;"> \
                                <p class="card__subTitle text-overflow">' + subtitles[i] + '</p> \
                                <p class="card__desc"> \
                                    Map description goes here. Map description goes here. Map description goes here. Map description goes here. Map description goes here. \
                                </p> \
                                <ul class="list-unstyled"> \
                                    <li class="tag"><a href="#" data-tag="data-maps-reports">Data, Maps, Reports</a></li> \
                                    <li class="tag"><a href="#" data-tag="maps">Maps</a></li> \
                                </ul> \
                            </div> \
                            <div class="card__footer"> \
                                <a class="btn-details btn btn-link btn-xs" href="#void" role="button" aria-pressed="false"><span class="icon icon-caret-right"></span>View details</a> \
                                <a class="btn btn-link btn-xs pull-right" href="' + url_bookmark + '"><span class="icon icon-external-link-square"></span>View map</a> \
                            </div> \
                        </li>';

                }

                var $items = $(text);

                $('.map-cards').append($items).isotope('insert', $items);

                /* for testing only */
                $('.map-cards > li').eq(2).addClass('tag-Fall2014 tag-multiLayer');
                $('.map-cards > li').eq(2).find('.card__body .list-unstyled').append('<li class="tag"><a href="#" data-tag="multiLayer">multiLayer</a></li>');
                $('.map-cards > li').eq(2).find('.card__body .list-unstyled').append('<li class="tag"><a href="#" data-tag="Fall2014">Fall 2014</a></li>');

                $('.map-cards > li').eq(5).addClass('tag-Fall2014');
                $('.map-cards > li').eq(5).find('.card__body .list-unstyled').append('<li class="tag"><a href="#" data-tag="Fall2014">Fall 2014</a></li>');

                $('.map-cards').isotope('updateSortData');
            }
        });

    }

    $(document).ready(function() {
        populateMaps();
    });
    </script>
</body>

</html>
